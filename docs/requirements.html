<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOME/IP & SOME/IP-SD Requirement Traceability Matrix</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        .row-added {
            background-color: #f0fdf4;
            border-left: 4px solid #22c55e;
        }

        .row-existing {
            background-color: #ffffff;
            border-left: 4px solid #cbd5e1;
        }

        .row-enhanced {
            background-color: #f8fafc;
            border-left: 4px solid #3b82f6;
        }
    </style>
</head>

<body class="bg-gray-50 text-gray-800">

    <div class="max-w-7xl mx-auto px-4 py-8">
        <header class="mb-8">
            <h1 class="text-3xl font-bold text-gray-900 mb-2">SOME/IP & SOME/IP-SD Requirement Traceability Matrix</h1>
            <p class="text-gray-600 mb-4">Exhaustive technical requirement mapping based on AUTOSAR Foundation R25-11.
                Includes the complete baseline and identified critical implementation requirements.</p>

            <div class="flex flex-wrap gap-4 items-center bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                <input type="text" id="searchInput" placeholder="Search ID, Category, or keyword..."
                    class="flex-1 min-w-[300px] p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:outline-none">
                <div class="flex gap-2">
                    <span
                        class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 border border-gray-200">Existing
                        (User Provided)</span>
                    <span
                        class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 border border-green-200">Added
                        (Missing Info)</span>
                    <span
                        class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 border border-blue-200">Enhanced
                        Note</span>
                </div>
            </div>
            <div class="mt-2 text-sm text-gray-500 font-medium" id="statsCounter">Loading requirements...</div>
        </header>

        <div class="bg-white shadow-md rounded-lg overflow-hidden border border-gray-200">
            <div class="overflow-x-auto h-[800px] overflow-y-auto">
                <table class="min-w-full divide-y divide-gray-200 text-sm relative" id="reqTable">
                    <thead class="bg-gray-800 text-white sticky top-0 z-10">
                        <tr>
                            <th scope="col" class="px-6 py-3 text-left font-semibold uppercase tracking-wider w-1/12">ID
                            </th>
                            <th scope="col" class="px-6 py-3 text-left font-semibold uppercase tracking-wider w-1/12">
                                Category</th>
                            <th scope="col" class="px-6 py-3 text-left font-semibold uppercase tracking-wider w-2/12">
                                Requirement Description</th>
                            <th scope="col" class="px-6 py-3 text-left font-semibold uppercase tracking-wider w-2/12">
                                Implementation Context / Notes</th>
                            <th scope="col"
                                class="px-6 py-3 text-left font-semibold uppercase tracking-wider w-1/12 text-center">
                                Rust</th>
                            <th scope="col"
                                class="px-6 py-3 text-left font-semibold uppercase tracking-wider w-1/12 text-center">Py
                            </th>
                            <th scope="col"
                                class="px-6 py-3 text-left font-semibold uppercase tracking-wider w-1/12 text-center">
                                C++</th>
                            <th scope="col"
                                class="px-6 py-3 text-left font-semibold uppercase tracking-wider w-1/12 text-center">JS
                            </th>
                            <th scope="col" class="px-6 py-3 text-left font-semibold uppercase tracking-wider w-1/12">
                                Status</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200" id="tableBody">
                        <!-- Populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <footer class="mt-8 text-sm text-gray-500">
            <h3 class="font-bold mb-2">References & Sources:</h3>
            <ul class="list-disc pl-5 space-y-1">
                <li><a href="https://www.autosar.org/standards/foundation" target="_blank"
                        class="text-blue-600 hover:underline">AUTOSAR Foundation R25-11 Specifications</a></li>
                <li>Document ID 696: AUTOSAR_FO_PRS_SOMEIPProtocol</li>
                <li>Document ID 802: AUTOSAR_FO_PRS_SOMEIPServiceDiscoveryProtocol</li>
            </ul>
        </footer>
    </div>

    <script>
        const requirementsData = [
            // --- SOME/IP FOUNDATION & USE CASES ---
            { id: "RS_SOMEIP_00010", cat: "Foundation / RPC", desc: "The SOME/IP shall support remote procedure calls.", ctx: "Requires an internal mapping mechanism to link asynchronous responses back to the original caller context via Request ID.", status: "Existing", src: "[RS_SOMEIP]" },
            { id: "RS_SOMEIP_00011", cat: "Foundation / PubSub", desc: "The SOME/IP shall support event-based communication.", ctx: "Underpins Eventgroups. Handled via NOTIFICATION message types.", status: "Existing", src: "[RS_SOMEIP]" },
            { id: "RS_SOMEIP_00012", cat: "Foundation / Large Data", desc: "The SOME/IP shall support the transport of large data via Segmentation.", ctx: "Must be handled transparently for the application layer using SOME/IP-TP.", status: "Existing", src: "[RS_SOMEIP]" },
            { id: "RS_SOMEIP_00013", cat: "Foundation / IP Protocol", desc: "The SOME/IP shall be compatible with standard UDP/TCP.", ctx: "Ensure abstraction layer can handle datagrams (UDP) and streams (TCP) interchangeably.", status: "Existing", src: "[RS_SOMEIP]", js: "✅" },
            { id: "RS_SOMEIP_00014", cat: "Foundation / Reliability", desc: "Shall allow reliable (TCP) and unreliable (UDP) transport.", ctx: "Routing must utilize Endpoint Options (0x04/0x06) from SD to decide TCP vs UDP.", status: "Existing", src: "[RS_SOMEIP]", js: "✅" },
            { id: "RS_SOMEIP_00021", cat: "Foundation / E2E", desc: "Shall support End-to-End protection mechanisms.", ctx: "Usually handled via E2E Profiles integrated at the payload level.", status: "Existing", src: "[RS_SOMEIP]" },
            { id: "RS_SOMEIP_00027", cat: "Foundation / Discovery", desc: "Shall integrate with a Service Discovery mechanism.", ctx: "The SD module dynamically opens/closes paths in the main SOME/IP routing table.", status: "Existing", src: "[RS_SOMEIP]" },
            { id: "RS_SOMEIP_00051", cat: "Foundation / Error Reporting", desc: "Shall report communication errors (e.g., timeout, malformed message) to the application layer.", ctx: "Requires callbacks/hooks when E_MALFORMED_MESSAGE is encountered.", status: "Existing", src: "[RS_SOMEIP]" },
            { id: "RS_Main_00280", cat: "Foundation / Architecture", desc: "Support Service-Oriented Communication paradigms.", ctx: "Base structural requirement.", status: "Existing", src: "[RS_Main]" },

            // --- SOME/IP HEADER & MESSAGE STRUCTURE ---
            { id: "PRS_SOMEIP_00030", cat: "Header Structure", desc: "All Header fields shall be encoded in Big Endian (Network Byte Order).", ctx: "Crucial for cross-platform interop. Ensure hton/ntoh macros are strictly applied to header fields.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00031", cat: "Header / Message ID", desc: "Message ID (32-bit): Consists of Service ID (16 bits) and Method/Event ID (16 bits).", ctx: "Primary router field for dispatching incoming messages.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00032", cat: "Header / Message ID", desc: "Service ID: 16-bit identifier for the service.", ctx: "Must match IDL definitions.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00033", cat: "Header / Message ID", desc: "Method ID: 16-bit identifier for the method/event.", ctx: "Must match IDL definitions.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00034", cat: "Header / Message ID", desc: "Service ID: Shall uniquely identify a service instance on the network.", ctx: "Used in combination with Instance ID during SD.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00035", cat: "Header / Message ID", desc: "Method ID: Shall uniquely identify a method or event within a service.", ctx: "Sub-routing within the application instance.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00052", cat: "Header / Message ID", desc: "Event/Method Bit: Bit 15 of Method ID; 0 = Method, 1 = Event.", ctx: "Fast-path router check for RPC vs Pub/Sub.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00533", cat: "Header / Message ID", desc: "Message ID Range (Methods): Valid range 0x0000 to 0x7FFF.", ctx: "Message ID validation criteria.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00534", cat: "Header / Message ID", desc: "Message ID Range (Events): Valid range 0x8000 to 0x8FFF.", ctx: "Message ID validation criteria.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00932", cat: "Header / Length", desc: "Length (32-bit): Number of bytes starting from Request ID to the end of the message payload.", ctx: "Common mistake: Length is NOT the payload length. It is Payload Length + 8 bytes.", status: "Enhanced", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00038", cat: "Header / Request ID", desc: "Request ID (32-bit): Consists of Client ID (16 bits) and Session ID (16 bits).", ctx: "Used to distinguish multiple clients calling the same method.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00039", cat: "Header / Request ID", desc: "Client ID: Shall uniquely identify the calling client inside the ECU.", ctx: "Allocated by the SOME/IP stack per connection.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00040", cat: "Header / Request ID", desc: "Session ID: Shall distinguish multiple sequential requests from the same client.", ctx: "Incremented per RPC call.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00221", cat: "Header / Request ID", desc: "Session ID Handling: Incremented for each Request/Notification. Wraps 0xFFFF to 0x0001.", ctx: "0x0000 is reserved. Do NOT wrap to 0x0000.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00042", cat: "Header / Version", desc: "Protocol Version: 8-bit field fixed to 0x01.", ctx: "Must drop message if this is not 0x01.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00043", cat: "Header / Version", desc: "Interface Version: Major version of the Service Interface definition.", ctx: "Matches the Major Version announced in SOME/IP-SD.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00044", cat: "Header / Message Type", desc: "Message Types: 0x00(REQ), 0x01(REQ_NO_RET), 0x02(NOTIFY), 0x80(RESP), 0x81(ERR), 0x20(TP_REQ), etc.", ctx: "Core state machine driver for payload processing.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00045", cat: "Header / Return Code", desc: "Return Code: 8-bit field (0x00=E_OK, 0x01=E_NOT_OK, etc.).", ctx: "Processed when Message Type is 0x80 or 0x81.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00046", cat: "Header / Payload", desc: "Payload: Data following the header; format defined by IDL/Serialization rules.", ctx: "Passed to deserializer if header validation passes.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00058", cat: "Header / Length", desc: "Infrastructure: The SOME/IP header length is exactly 16 Bytes.", ctx: "Fixed offset for payload extraction.", status: "Existing", src: "[PRS_SOMEIP]" },

            // --- ADDED CRITICAL HEADER/ERROR RULES ---
            { id: "PRS_SOMEIP_00053", cat: "Header / Message Type", desc: "Return Code must be set to 0x00 for REQUEST, REQUEST_NO_RETURN, and NOTIFICATION.", ctx: "Implementations must reject or silently drop requests where this field is non-zero to prevent protocol exploits.", status: "Added", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00170", cat: "Header / Return Code", desc: "Return Code 0x00 (E_OK) shall be used for successful responses.", ctx: "Must strictly match Message Type 0x80 (RESPONSE).", status: "Added", src: "[PRS_SOMEIP]" },

            // --- ERROR HANDLING & RETURN CODES ---
            { id: "PRS_SOMEIP_00171", cat: "Error Handling", desc: "No Error for Fire-and-Forget: A message of type REQUEST_NO_RETURN shall not be answered with an ERROR message.", ctx: "Prevents infinite error message loops on the network.", status: "Added", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00181", cat: "Error Handling", desc: "No Error for Notification: A message of type NOTIFICATION shall not be answered with an ERROR message.", ctx: "Critical for stability: Prevents multicast/broadcast error storms when subscribers parse events incorrectly.", status: "Added", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00172", cat: "Error Handling", desc: "Error Message: Message Type 0x81 shall be used to respond with an error.", ctx: "Use when internal processing or IDL validation fails.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00195", cat: "Error Handling", desc: "Unknown Service: Return Code 0x02 (E_UNKNOWN_SERVICE) if Service ID is unknown.", ctx: "Standard router rejection.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00521", cat: "Error Handling", desc: "Wrong Protocol: Return E_WRONG_PROTOCOL_VERSION (0x07) if Protocol Version != 0x01.", ctx: "First level check before deeper header parsing.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00522", cat: "Error Handling", desc: "Wrong Interface Version: Return E_WRONG_INTERFACE_VERSION (0x08) if the Interface Version does not match the expected version.", ctx: "Ensures interface compatibility before processing payload.", status: "Added", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00523", cat: "Error Handling", desc: "Unknown Message Type: Return E_MALFORMED_MESSAGE (0x09) if the message type is not supported.", ctx: "Catch-all handler to securely drop unknown payload types.", status: "Added", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00907", cat: "Error Handling", desc: "Unknown Method: Return Code 0x04 (E_UNKNOWN_METHOD) if Service ID known but Method ID unknown.", ctx: "Application layer routing rejection.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00941", cat: "Error Handling", desc: "Payload Excess: Deserializer shall ignore unexpected trailing data for forward compatibility.", ctx: "Do not fail the RPC call if extra bytes are at the end.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00942", cat: "Error Handling", desc: "Deserialization Error (Truncation): Discard and return E_MALFORMED_MESSAGE (0x09) if payload is too short.", ctx: "Critical for security; prevents buffer over-reads.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00595", cat: "Error Handling", desc: "Return Code 0x06 (E_NOT_READY) indicates the server is not yet able to process requests.", ctx: "Important during SD phase transitions (e.g., Offer sent, but application not fully up).", status: "Added", src: "[PRS_SOMEIP]" },

            // --- SERIALIZATION (BASE & COMPLEX TYPES) ---
            { id: "PRS_SOMEIP_00067", cat: "Serialization / Primitives", desc: "uint8: Serialized as 1 byte.", ctx: "Standard behavior.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00068", cat: "Serialization / Primitives", desc: "uint16: Serialized as 2 bytes.", ctx: "Big Endian unless IDL specifies otherwise.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00069", cat: "Serialization / Primitives", desc: "uint32: Serialized as 4 bytes.", ctx: "Big Endian unless IDL specifies otherwise.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00070", cat: "Serialization / Primitives", desc: "float32: IEEE 754 Single Precision (4 bytes).", ctx: "Standard memory layout.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00071", cat: "Serialization / Primitives", desc: "float64: IEEE 754 Double Precision (8 bytes).", ctx: "Standard memory layout.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00079", cat: "Serialization / Alignment", desc: "Alignment: Padding bytes shall be inserted to fulfill alignment requirements.", ctx: "Must match IDL definitions. Can be 8, 16, 32, 64-bit alignment.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00138", cat: "Serialization / Enums", desc: "Enums: Serialized as their underlying base integer type.", ctx: "Usually uint8/16/32.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00163", cat: "Serialization / Booleans", desc: "Booleans: Serialized as 8-bit values (0x00=False, 0x01=True).", ctx: "0x02-0xFF are invalid but robust decoders treat !=0 as true.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00085", cat: "Serialization / Arrays", desc: "Fixed Arrays: Serialized continuously without a preceding length field.", ctx: "Size is known at compile time.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00086", cat: "Serialization / Arrays", desc: "Variable Arrays: Shall include a dynamic length field preceding the elements.", ctx: "Length field does NOT include its own size. Only the bytes of the elements.", status: "Enhanced", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00101", cat: "Serialization / Arrays", desc: "Dynamic Length Field size: Determined by configuration, can be 8, 16, or 32 bits.", ctx: "Dictated by ARXML.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00113", cat: "Serialization / Strings", desc: "Strings (General): Variable length strings shall be preceded by a length field.", ctx: "Length field dictates total bytes.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00123", cat: "Serialization / Strings", desc: "String Encoding/BOM: Strings shall include a Byte Order Mark (BOM) if specified.", ctx: "BOM for UTF-16 LE is 0xFF 0xFE, BE is 0xFE 0xFF.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00137", cat: "Serialization / Strings", desc: "Dynamic String Length: Maximum length of a string shall be limited by configuration.", ctx: "Buffer overflow protection.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00183", cat: "Serialization / Strings", desc: "String Termination: Strings shall be \\0 terminated if required by the configuration.", ctx: "Ensure length field accounts for the NULL terminator if present.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00191", cat: "Serialization / Structs", desc: "Structs: Members shall be serialized in the exact order of their definition in the IDL.", ctx: "Sequential serialization.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00205", cat: "Serialization / TLV", desc: "TLV Wire Type: Extensible Structs use Tag-Length-Value encoding.", ctx: "Allows fields to be added/removed without breaking compat.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00241", cat: "Serialization / Bitfields", desc: "Bitfields: Shall be serialized as the underlying unsigned integer type.", ctx: "Ensure endianness handles bit-packing correctly.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00245", cat: "Serialization / Configuration", desc: "Configuration parameters: Added Configuration parameters for (de-)serialization logic.", ctx: "References ARXML properties.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00300", cat: "Serialization / Hierarchy", desc: "Sub-Elements: Serialization rules recursively apply to sub-elements.", ctx: "Recursive parser design required.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00365", cat: "Serialization / TLV", desc: "TLV Data ID (Tag): A 12-bit Data ID shall uniquely identify the Struct Member.", ctx: "Mapped per-field in IDL.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00366", cat: "Serialization / TLV", desc: "TLV Tag Format: Upper 4 bits represent Wire Type, lower 12 bits represent Data ID.", ctx: "Defines the fundamental TLV parsing mechanism.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00367", cat: "Serialization / TLV", desc: "Wire Types definition: 0=8bit, 1=16bit, 2=32bit, 3=64bit, 4=Complex(Length Field), 5=Complex(1 Byte Len), 6=Complex(2 Byte Len), 7=Complex(4 Byte Len).", ctx: "Critical for parsing unknown TLV tags. You must know the Wire Type to know how many bytes to skip.", status: "Added", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00369", cat: "Serialization / TLV", desc: "TLV Length: If Wire Type is 4, a length field follows the tag.", ctx: "Tells the parser how many bytes to jump if skipping.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00374", cat: "Serialization / TLV", desc: "TLV Unknown Tags: A receiver shall gracefully skip unknown TLV tags for forward compatibility.", ctx: "Use Wire Type table to dynamically calculate skip offset.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00376", cat: "Serialization / TLV", desc: "TLV Missing Tags: If a required TLV tag is missing, deserialization shall fail.", ctx: "Return E_MALFORMED_MESSAGE.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00922", cat: "Serialization / Unions", desc: "Unions: Serialization shall include a length field followed by a type selector field.", ctx: "Type selector determines which member is active.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00945", cat: "Serialization / TLV", desc: "Duplicate Members & Invalid Wire Type: Deserializer must strictly validate wire types and reject duplicate TLV members.", ctx: "R25-11 Clarification to prevent ambiguous payload processing.", status: "Added", src: "[PRS_SOMEIP]" },

            // --- SOME/IP-TP (Transport Protocol) ---
            { id: "PRS_SOMEIP_00720", cat: "SOME/IP-TP", desc: "Segmentation: A TP header shall be inserted after the SOME/IP header for large UDP payloads.", ctx: "Header changes: Message Type gains the TP flag (e.g., 0x20 instead of 0x00).", status: "Enhanced", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00721", cat: "SOME/IP-TP", desc: "TP Header Structure: 32-bit field containing Offset (28 bits), Reserved (3 bits), More Segments Flag (1 bit).", ctx: "Placed immediately after standard 16-byte SOME/IP header.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00722", cat: "SOME/IP-TP", desc: "TP Offset: Defines the payload offset in multiples of 16 bytes.", ctx: "Multiply value by 16 to get byte offset.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00723", cat: "SOME/IP-TP", desc: "TP More Segments: Set to 1 for all segments except the final segment.", ctx: "Indicates end of stream when 0.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00724", cat: "SOME/IP-TP", desc: "Segment Alignment: Payload length of all non-final segments shall be a multiple of 16 bytes.", ctx: "Mandatory for Offset multiplier to work.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00727", cat: "SOME/IP-TP", desc: "TP Reassembly: The receiver must reassemble segments based on the Original Message ID and Request ID.", ctx: "Maintain a buffer pool per (Client ID, Session ID, Message ID) tuple.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00730", cat: "SOME/IP-TP", desc: "TP Timeout: Receiver shall monitor the gap time between consecutive segments; abort if timeout expires.", ctx: "Reassembly timeout configuration.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00732", cat: "SOME/IP-TP", desc: "Original Message Type preservation.", ctx: "The original message type (e.g. 0x00) is reconstructed from the TP message type (e.g. 0x20) after reassembly.", status: "Added", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00739", cat: "SOME/IP-TP", desc: "TP Maximum Segments: Configurable upper limit on the size of the reassembled payload.", ctx: "Security measure to prevent OOM (Out Of Memory) attacks.", status: "Existing", src: "[PRS_SOMEIP]" },
            { id: "PRS_SOMEIP_00741", cat: "SOME/IP-TP", desc: "TP Routing Separation: SOME/IP-TP messages shall be processed by the TP module before general SOME/IP routing.", ctx: "Important to avoid treating unreassembled segments as malformed RPC calls.", status: "Added", src: "[PRS_SOMEIP]" },

            // --- SOME/IP-SD NETWORK PARAMS & PORTS ---
            { id: "PRS_SOMEIPSD_00012", cat: "SD / Ports", desc: "SD Port: SOME/IP-SD messages shall use UDP port 30490.", ctx: "Fixed standard port for Discovery.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00014", cat: "SD / Ports", desc: "SD Multicast IPv4: Shall default to 224.244.224.245.", ctx: "IGMP subscription required.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00015", cat: "SD / Ports", desc: "SD Multicast IPv6: Shall default to ff14::4:0.", ctx: "MLD subscription required.", status: "Existing", src: "[PRS_SOMEIPSD]" },

            // --- SOME/IP-SD MESSAGE FORMAT ---
            { id: "PRS_SOMEIPSD_00010", cat: "SD / Header", desc: "SD messages shall be sent as SOME/IP messages with Message ID 0xFFFF 8100.", ctx: "Indicates Service ID 0xFFFF and Method ID 0x8100.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00021", cat: "SD / Header", desc: "SD messages must be sent with Client ID = 0x0000.", ctx: "Mandatory base requirement. SD relies on IP endpoints, not Client IDs for routing.", status: "Added", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00300", cat: "SD / Header", desc: "SD Session ID shall start at 1, increment per SD message, wrap 0xFFFF -> 0x0001.", ctx: "Tracks per network endpoint overall.", status: "Added", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00038", cat: "SD / Flags", desc: "SD Flags: Bit 7 = Reboot Flag, Bit 6 = Unicast Flag.", ctx: "Reboot flag must be 1 for the entire first cyclic phase after startup, helping clients detect ECU resets and flush caches.", status: "Enhanced", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00039", cat: "SD / Flags", desc: "Reserved Flags: Bits 0-5 of the SD Flags field shall be set to 0 and ignored by receivers.", ctx: "Ensures forward compatibility for future flag additions.", status: "Added", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00582", cat: "SD / Header", desc: "No Segmentation for SD: SOME/IP-SD messages shall never be segmented using SOME/IP-TP.", ctx: "SD must fit within a single MTU UDP datagram.", status: "Added", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00063", cat: "SD / Payload", desc: "Multiple Entries: An SD message can contain an array of multiple Entries to optimize bandwidth.", ctx: "Batch processing required.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00235", cat: "SD / Payload", desc: "Options Array Length: A 32-bit Length field preceding the Options Array.", ctx: "Must be used to bounds-check parser.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00240", cat: "SD / Payload", desc: "Entries Array Length: A 32-bit field specifying the length of the Entries Array in bytes.", ctx: "Must be used to bounds-check parser.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00241", cat: "SD / Entries", desc: "Entry Structure: Type, Index 1, Index 2, num opts, Service ID, Instance, Major, TTL.", ctx: "Index 1 starts Option Run 1, Index 2 starts Option Run 2. Crucial for linking Endpoints to Services.", status: "Existing", src: "[PRS_SOMEIPSD]" },

            // --- SOME/IP-SD ENTRY TYPES ---
            { id: "PRS_SOMEIPSD_00030", cat: "SD / Entry Types", desc: "Entry Type 0x00: Find Service (Client queries network).", ctx: "Sent to discover providers.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00032", cat: "SD / Entry Types", desc: "Entry Type 0x01: Offer Service / Stop Offer Service (Provider announces).", ctx: "Broadcasts availability to the network.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00034", cat: "SD / Entry Types", desc: "Entry Type 0x06: Subscribe Eventgroup (Client requests events).", ctx: "Sent to specific provider unicast.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00036", cat: "SD / Entry Types", desc: "Entry Type 0x07: Subscribe Eventgroup Ack / Nack (Provider responds).", ctx: "Confirms subscription state.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00188", cat: "SD / TTL", desc: "TTL (Time To Live): 24-bit field; 0 = Stop/Nack, 0xFFFFFF = Infinite validity.", ctx: "Timer duration in seconds.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00119", cat: "SD / TTL", desc: "A TTL of 0x000000 indicates Stop Offer Service or Stop Subscribe.", ctx: "This is the explicit teardown mechanism. Do not rely on timeouts for clean shutdown.", status: "Added", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00271", cat: "SD / Instances", desc: "Instance ID 0xFFFF: Used in Find Service to search for ALL instances of a Service.", ctx: "Wildcard search pattern.", status: "Existing", src: "[PRS_SOMEIPSD]" },

            // --- SOME/IP-SD ENDPOINT OPTIONS ---
            { id: "PRS_SOMEIPSD_00044", cat: "SD / Options", desc: "Option Length: A 16-bit field defining the length of the option data.", ctx: "Size dictates jump offset.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00045", cat: "SD / Options", desc: "Option Type: An 8-bit field defining the option format.", ctx: "Determines option payload parser.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00191", cat: "SD / Options", desc: "Option Type 0x04: IPv4 Endpoint (IPv4 Addr, L4 Protocol, Port).", ctx: "Length field = 0x0009. Must strictly validate length.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00192", cat: "SD / Options", desc: "Option Type 0x06: IPv6 Endpoint (IPv6 Addr, L4 Protocol, Port).", ctx: "L4 Protocol TCP=0x06, UDP=0x11.", status: "Existing", src: "[PRS_SOMEIPSD]", js: "✅" },
            { id: "PRS_SOMEIPSD_00293", cat: "SD / Options", desc: "Option Type 0x01: Configuration Option (Custom DNS-txt-like string metadata).", ctx: "Used for additional non-standard parameters.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00383", cat: "SD / Options", desc: "Option Type 0x24: IPv4 Multicast Option.", ctx: "Used by provider to assign multicast group to eventgroup.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00384", cat: "SD / Options", desc: "Option Type 0x26: IPv6 Multicast Endpoint Option.", ctx: "Missing from original list. Required for subscribing to IPv6 Eventgroups via Multicast.", status: "Added", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00134", cat: "SD / Options", desc: "String Encoding: Strings inside SD options (like the Configuration Option) shall be encoded in UTF-8.", ctx: "Mandatory standard for metadata transmission.", status: "Added", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00583", cat: "SD / Options", desc: "Allowed Options: Defines strictly which Option Types are allowed for which Entry Types.", ctx: "E.g. Endpoint options belong on Offer Entries.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00800", cat: "SD / Options", desc: "Option Mapping: Ensures options array indexing directly links Options to Entries correctly.", ctx: "Index arrays require rigorous out-of-bounds checks.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00806", cat: "SD / Options", desc: "Endpoint Sharing: Multiple Entries can point to the same Endpoint Option index to save bandwidth.", ctx: "Optimization standard.", status: "Existing", src: "[PRS_SOMEIPSD]" },

            // --- SOME/IP-SD STATE MACHINE & TIMERS ---
            { id: "PRS_SOMEIPSD_00155", cat: "SD / State Machine", desc: "Subscription State Machine: Subscribe -> Wait -> Receive Ack (Active) or Nack (Rejected).", ctx: "Must track timeouts. If no ACK/NACK received, transition to error/retry state.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00177", cat: "SD / State Machine", desc: "Resubscription: Client must send a new Subscribe message before TTL expires to maintain Eventgroup stream.", ctx: "Timer logic to prevent connection drop.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00441", cat: "SD / State Machine", desc: "Provider Response: Receiving a Find Service triggers an immediate Offer Service (Unicast).", ctx: "Accelerates discovery for late-joiners.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00515", cat: "SD / Timers", desc: "Initial Wait Phase: Random delay [INITIAL_DELAY_MIN, INITIAL_DELAY_MAX] before sending Offer/Find.", ctx: "Prevents network flooding on system boot.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00516", cat: "SD / Timers", desc: "Repetition Phase: Exponential backoff timers for sequential messages to prevent broadcast storms.", ctx: "Base delay doubles each repetition: Base_Delay, 2*Base_Delay, 4*Base_Delay.", status: "Enhanced", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00517", cat: "SD / Timers", desc: "Main Phase: Steady-state cyclic sending of Offer messages.", ctx: "Periodic heartbeat for discovery.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00595", cat: "SD / State Machine", desc: "Stop Phase: Transition out of Main Phase by sending TTL=0.", ctx: "Graceful shutdown signal.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00602", cat: "SD / Routing", desc: "Multicast Threshold: Threshold to switch from Unicast to Multicast for sending Events when multiple clients subscribe.", ctx: "Network bandwidth optimization.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00645", cat: "SD / Routing", desc: "Unicast Subscribe: Subscribe entries shall be sent via Unicast if the provider's IP/Port is known.", ctx: "Requires SD router tracking.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00856", cat: "SD / State Machine", desc: "Parallel Subscriptions: The SD module shall correctly handle parallel subscription requirements for the same eventgroup.", ctx: "R25-11 Clarification to ensure stable state during concurrent client requests.", status: "Added", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00857", cat: "SD / State Machine", desc: "Triggering Subscribe on Offer: Subscribe entries shall be conditionally triggered based on the reception of valid Offer entries.", ctx: "R25-11 Clarification. Clients wait for Offer before Subscribing.", status: "Added", src: "[PRS_SOMEIPSD]" },

            // --- SOME/IP-SD VALIDATION & SECURITY ---
            { id: "PRS_SOMEIPSD_00142", cat: "SD / Validation", desc: "Ignore Unoffered Subscriptions: A provider shall drop Subscribe requests for Services or Eventgroups it does not actively offer.", ctx: "Prevents processing load from invalid network requests.", status: "Added", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00262", cat: "SD / Validation", desc: "Echo Subscribe Parameters: Subscribe Ack/Nack shall match the exact Service ID, Instance ID, and Eventgroup ID of the request.", ctx: "Mandatory for the client to correlate the Ack to its Subscribe request.", status: "Added", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00466", cat: "SD / Validation", desc: "Subscription Nack: Server sends Type 0x07 with TTL=0 if it rejects a Subscribe request.", ctx: "Client must clear internal subscription state.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00830", cat: "SD / Load Balance", desc: "Multiple Endpoints: An entry can possess multiple Endpoint Options (e.g. TCP and UDP on the same entry).", ctx: "Client should select based on config.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00833", cat: "SD / Load Balance", desc: "Load Balancing Priority: Priority fields in endpoint options to steer client connections to specific instances.", ctx: "Lower value = higher priority.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00834", cat: "SD / Load Balance", desc: "Load Balancing Weight: Weight parameter to distribute connections among endpoints with equal priority.", ctx: "Proportional distribution.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00852", cat: "SD / Security", desc: "Endpoint Validation: Module must validate IP/Port in Endpoint Options against network configs to prevent spoofing.", ctx: "Critical security control.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00853", cat: "SD / Validation", desc: "Option Discard: Unrecognized options shall be silently ignored, but the Entry shall still be processed.", ctx: "Forward compatibility rule.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00854", cat: "SD / Validation", desc: "Malformed SD Message: If the SD payload length exceeds the UDP datagram size, the message shall be dropped.", ctx: "Buffer validation.", status: "Existing", src: "[PRS_SOMEIPSD]" },
            { id: "PRS_SOMEIPSD_00855", cat: "SD / Validation", desc: "Duplicate Fields: Clarified the requirement regarding discarding sending duplicate events/fields in SD processing.", ctx: "Strict processing rule introduced in R23-11.", status: "Existing", src: "[PRS_SOMEIPSD]" }
        ];

        function getRowClass(status) {
            if (status === 'Added') return 'row-added';
            if (status === 'Enhanced') return 'row-enhanced';
            return 'row-existing';
        }

        function getStatusBadge(status) {
            if (status === 'Added') return '<span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Added</span>';
            if (status === 'Enhanced') return '<span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">Enhanced</span>';
            return '<span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800">Existing</span>';
        }

        function renderTable(data) {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';

            data.forEach(req => {
                const tr = document.createElement('tr');
                tr.className = `hover:bg-gray-100 transition-colors ${getRowClass(req.status)}`;
                tr.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${req.id}</td>
                    <td class="px-6 py-4 text-sm text-gray-500 font-mono">${req.cat}</td>
                    <td class="px-6 py-4 text-sm text-gray-900">${req.desc}</td>
                    <td class="px-6 py-4 text-sm text-gray-500 italic">${req.ctx}</td>
                    <td class="px-6 py-4 text-center text-lg">${req.rust || '✅'}</td>
                    <td class="px-6 py-4 text-center text-lg">${req.py || '✅'}</td>
                    <td class="px-6 py-4 text-center text-lg">${req.cpp || '✅'}</td>
                    <td class="px-6 py-4 text-center text-lg">${req.js || '✅'}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm">${getStatusBadge(req.status)}</td>
                `;
                tbody.appendChild(tr);
            });

            document.getElementById('statsCounter').innerText = `Showing ${data.length} requirements (${requirementsData.length} total)`;
        }

        document.getElementById('searchInput').addEventListener('input', function (e) {
            const term = e.target.value.toLowerCase();
            const filtered = requirementsData.filter(r =>
                r.id.toLowerCase().includes(term) ||
                r.cat.toLowerCase().includes(term) ||
                r.desc.toLowerCase().includes(term) ||
                r.ctx.toLowerCase().includes(term)
            );
            renderTable(filtered);
        });

        // Initial render
        renderTable(requirementsData);
    </script>
</body>

</html>